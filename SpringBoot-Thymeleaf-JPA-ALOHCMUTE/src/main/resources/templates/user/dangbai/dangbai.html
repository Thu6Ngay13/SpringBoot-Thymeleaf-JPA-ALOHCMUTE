<html xmlns:th "http://www.thymeleaf.org" xmlns:layout="http://ww.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{user/layout-user.html}">
<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
	<meta charset="utf-8">
	<title>Đăng bài</title>
	<link rel="stylesheet" th:href="@{css/style_dangbai.css}">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- FontAweome CDN Link for Icons -->
	<link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css}" />
	<style>
		body {
			margin-left: 23%;
			margin-top: 3.5%;
			padding: 0;
			box-sizing: border-box;
			background-color: aliceblue;
		}
	</style>

</head>

<body>
	<section layout:fragment="content">
		<div class="container">
			<div class="wrapper">
				<section class="post">
					<header>Đăng bài</header>
					<form action="#" th:action="@{dangbai/add}" method="POST">
						<div class="content">
							<img th:src="${taikhoan.avatarURl}" alt="logo" class="imgavatar">
							<div class="details">
								<b th:text="${taikhoan.hoTen}"
									style="margin-left: 5px; margin-bottom: 5px; font-family: 'Consolas', Times, serif; font-size: 20px;"></b>
								</br>
								<select name="privacy" id="privacy" class="combobox">
									<option value="Public">Công Khai</option>
									<option value="Follower">Người Theo Dõi</option>
									<option value="Private">Riêng Tư</option>
								</select>
							</div>
						</div>
						<textarea id="postContent" name="noidungchu" placeholder="Bạn đang nghĩ gì?" spellcheck="false"
							required onkeyup="suggestNames(event)"></textarea>
						<div id="suggestions" class="suggestions-container"></div>
						<div class="theme-emoji">
							<img src="/images/theme.svg" alt="theme">
							<img src="/images/smile.svg" alt="smile">
						</div>
						<div class="options">
							<p>Thêm vào bài đăng</p>
							<ul class="list">
								<li><img src="/images/gallery.svg" alt="gallery"></li>
								<li><img src="/images/tag.svg" alt="gallery"></li>
								<li><img src="/images/emoji.svg" alt="gallery"></li>
								<li><img src="/images/mic.svg" alt="gallery"></li>
								<li><img src="/images/more.svg" alt="gallery"></li>
							</ul>
						</div>
						<button class="buttondangbai" type="submit">Đăng</button>
					</form>
				</section>
				<section class="audience">
					<header>
						<div class="arrow-back"><i class="fas fa-arrow-left"></i></div>
						<p>Select Audience</p>
					</header>
					<div class="content">
						<p>Who can see your post?</p>
						<span>Your post will show up in News Feed, on your profile and in search results.</span>
					</div>


				</section>
			</div>
		</div>

		<script language="javascript">
			const container = document.querySelector(".container"),
				privacy = container.querySelector(".post .privacy"),
				arrowBack = container.querySelector(".audience .arrow-back");
			privacy.addEventListener("click", () => {
				container.classList.add("active");
			});
			arrowBack.addEventListener("click", () => {
				container.classList.remove("active");
			});
			document.getElementById("btn1").onclick = function () {
				var checkbox = document.getElementsByName("contact");
				for (var i = 0; i < checkbox.length; i++) {
					if (checkbox[i].checked === true) {
						alert(checkbox[i].value);
					}
				}
			};
		</script>

		<script th:inline="javascript">
			/*<![CDATA[*/
			var listbanbe = /*[[${listbanbe}]]*/[];
  /*]]>*/
		</script>
		
		<script language="javascript">
			function suggestNames(event) {
				var input = event.target.value;
				var suggestions = document.getElementById("suggestions");

				// Use 'listbanbe' directly in your JavaScript
				var atIndex = input.lastIndexOf("@");
				if (atIndex >= 0) {
					var searchQuery = input.substring(atIndex + 1);
					if (searchQuery.length > 0) {
						var matchingFriends = listbanbe.filter(name => name.toLowerCase().startsWith(searchQuery.toLowerCase()));
						suggestions.innerHTML = matchingFriends.map(name => `<div class="suggestion-item">${name}</div>`).join('');
						suggestions.style.display = 'block';

						// Add click event to suggestion items
						document.querySelectorAll('.suggestion-item').forEach(item => {
							item.addEventListener('click', function () {
								var name = this.innerText;
								var newText = input.substring(0, atIndex) + "@" + name + " ";
								document.getElementById("postContent").value = newText;
								suggestions.style.display = 'none';
							});
						});
					} else {
						suggestions.style.display = 'none';
					}
				} else {
					suggestions.style.display = 'none';
				}
			}
			
			

		</script>





	</section>
</body>

</html>